# E-Commerce API

## Overview

This is a RESTful API to simulate an E-Commerce API Backend. The API used so user can browse, search, and put products to a cart, order all the products from the cart, and then pass it to the payment step.
The API used ExpressJS for the routing, Prisma for the ORM, and Mysql as the database.

## Instalation

Run in terminal to install necessary package

`npm install`

Create the database using the command below on the terminal

`npx prisma migrate dev`

Seeds the necessary data for Products, Users and Roles

`node database/product-seeds.js` for Products

`node database/user-seeds.js` for Users and Roles

## Running the App

Run the API for the app and Payment Gateway server
For API Server

`npm start`

For Payment Gateway, open in different terminal

`cd database/dummy-payment-gateway-main/`

`npm start`

API Server will run in Port 4200, while Payment Gateway will run in Port 3000

## Actors

There two Role in this API :

1. Seller :

- Able to Browse, View, Add, Update, and Remove a Product. Can't making an order or putting product on a cart
- The Seller role automatically generated by user-seeds.js
- Used `passwordsellet` as default password

2. Regular User :

- Only able to browse products and view a product detail, but can't add, remove, or update a product.
- used `password` as default password

## API Endpoint

### Register Endpoint

- URL: /register
- Method: POST
- Content-Type: application/json
- Description: Register a user with name, email and password

#### Request Body

| Attribute  | Type   | Description         | Required |
| ---------- | ------ | ------------------- | -------- |
| `name`     | String | The user full name. | Yes      |
| `email`    | String | The user email.     | Yes      |
| `password` | String | The user password.  | Yes      |

#### Sample Request

```
{
      "name" : "anonymous",
      "email" : "awanama@gmail.com",
      "password" : "password"
}
```

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing inputs or existed email)

##### Success Response Body

```
{
    "message": "Register Success"
}
```

##### Error Response Body

```
{
    "message": "Missing required fields"
}
```

### Login Endpoint

- URL: /login
- Method: POST
- Content-Type: application/json
- Description: Generate the user's token by login with registered email and password.

#### Request Body

| Attribute  | Type   | Description        | Required |
| ---------- | ------ | ------------------ | -------- |
| `email`    | String | The user email.    | Yes      |
| `password` | String | The user password. | Yes      |

#### Sample Request

```
{
      "name" : "anonymous",
      "email" : "awanama@gmail.com",
      "password" : "password"
}
```

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing fields)

##### Success Response Body Example

```
{
    "token": "n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw=="
}
```

##### Error Response Body Example

```
{
    "email": "Email is required"
}
```

### View All Products Endpoint

- URL: /products
- Method: GET
- Content-Type: application/json
- Description: View all available Products, needed Header Request for registered token. Able to use name, category, and description as search query.

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing token or no products found)

##### Success Response Body Example

`localhost:4200/products?category=garden`

```
{
    [
    {
        "id": 1,
        "name": "Elegant Cotton Chips",
        "category": "Garden",
        "price": 3650850,
        "in_stock": true,
        "description": "The slim & simple Maple Gaming Keyboard from Dev Byte comes with a sleek body and 7- Color RGB LED Back-lighting for smart functionality",
        "created_at": "2024-02-17T12:52:44.872Z",
        "updated_at": "2024-02-17T12:52:44.872Z"
    },
    {
        "id": 15,
        "name": "Intelligent Fresh Pizza",
        "category": "Garden",
        "price": 2660023,
        "in_stock": true,
        "description": "Boston's most advanced compression wear technology increases muscle oxygenation, stabilizes active muscles",
        "created_at": "2024-02-17T12:52:44.977Z",
        "updated_at": "2024-02-17T12:52:44.977Z"
    }
]
}
```

##### Error Response Body Example

`no products found`

```
{
    "message": "Products not found"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### View a Product Endpoint

- URL: /products/:id
- Method: GET
- Content-Type: application/json
- Description: View a single Product, needed Header Request for registered token.

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing token or no products found)

##### Success Response Body Example

`localhost:4200/products/1

```
{
    "id": 1,
    "name": "Elegant Cotton Chips",
    "category": "Garden",
    "price": 3650850,
    "in_stock": true,
    "description": "The slim & simple Maple Gaming Keyboard from Dev Byte comes with a sleek body and 7- Color RGB LED Back-lighting for smart functionality",
    "created_at": "2024-02-17T12:52:44.872Z",
    "updated_at": "2024-02-17T12:52:44.872Z"
}
```

##### Error Response Body Example

`no products found`

```
null
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Add a Product Endpoint

- URL: /products
- Method: POST
- Content-Type: application/json
- Description: Add a single Product, needed Header Request for registered token for seller role.

#### Request Header and Body

| Key             | Type   | Description                  | Required |
| --------------- | ------ | ---------------------------- | -------- |
| `Authorization` | String | The registered seller token. | Yes      |

| Attribute     | Type    | Description              | Required |
| ------------- | ------- | ------------------------ | -------- |
| `name`        | String  | The product name.        | Yes      |
| `category`    | String  | The product category.    | Yes      |
| `in_stock`    | Boolean | The stock status.        | Yes      |
| `price`       | Number  | The product price.       | Yes      |
| `description` | String  | The product description. | No       |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description  | Required |
| --------------- | ---------------------------------------------------------------------------------------- | ------------ | -------- |
| `Authorization` | 4QKaSVUWSJsmitN0sSFzYEP85ooj/Y/6yGfcd/98EC3UcMkZvik39ZAIXlBLMup0zGcIs4wmFLPMnZgQVpUCAw== | Seller Token | Yes      |

#### Sample Request

```
{
    "name" : "New Product",
    "category" : "Home",
    "in_stock" : true,
    "price" : 5000,
    "description" : "new product description"
}
```

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing fields or token)

##### Success Response Body Example

`POST localhost:4200/products/`

```
{
    "message": "Product created successfully",
    "product": {
        "id": 51,
        "name": "Produk Baru",
        "category": "Home",
        "price": 5000,
        "in_stock": true,
        "description": "new product description",
        "created_at": "2024-02-18T03:04:48.534Z",
        "updated_at": "2024-02-18T03:04:48.534Z"
    }
}
```

##### Error Response Body Example

`missing fields`

```
{
    "message": "Missing required fields"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Update a Product Endpoint

- URL: /products/1
- Method: PUT
- Content-Type: application/json
- Description: Update a Product, needed Header Request for registered token for seller role and Body Request

#### Request Header and Body

| Key             | Type   | Description                  | Required |
| --------------- | ------ | ---------------------------- | -------- |
| `Authorization` | String | The registered seller token. | Yes      |

| Attribute     | Type    | Description              | Required |
| ------------- | ------- | ------------------------ | -------- |
| `name`        | String  | The product name.        | Yes      |
| `category`    | String  | The product category.    | Yes      |
| `in_stock`    | Boolean | The stock status.        | Yes      |
| `price`       | Number  | The product price.       | Yes      |
| `description` | String  | The product description. | No       |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description  | Required |
| --------------- | ---------------------------------------------------------------------------------------- | ------------ | -------- |
| `Authorization` | 4QKaSVUWSJsmitN0sSFzYEP85ooj/Y/6yGfcd/98EC3UcMkZvik39ZAIXlBLMup0zGcIs4wmFLPMnZgQVpUCAw== | Seller Token | Yes      |

#### Sample Request

```
{
    "name" : "Edit Product",
    "category" : "Home",
    "in_stock" : true,
    "price" : 5000,
    "description" : "Edited product description"
}
```

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing fields or token)

##### Success Response Body Example

`PUT localhost:4200/products/1`

```
{
    "message": "Product updated successfully",
    "product": {
        "id": 51,
        "name": "Edit Nama Produk",
        "category": "Movies",
        "price": 3000,
        "in_stock": true,
        "description": "Edit deskripsi produk",
        "created_at": "2024-02-18T03:04:48.534Z",
        "updated_at": "2024-02-18T03:10:55.056Z"
    }
}
```

##### Error Response Body Example

`missing fields`

```
{
    "message": "Missing required fields"
}
```

`no product`

```
{
    "message": "Not found"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Delete a Product Endpoint

- URL: /products/1
- Method: DELETE
- Content-Type: application/json
- Description: Delete a Product, needed Header Request for registered token for seller role.

#### Request Header

| Key             | Type   | Description                  | Required |
| --------------- | ------ | ---------------------------- | -------- |
| `Authorization` | String | The registered seller token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description  | Required |
| --------------- | ---------------------------------------------------------------------------------------- | ------------ | -------- |
| `Authorization` | 4QKaSVUWSJsmitN0sSFzYEP85ooj/Y/6yGfcd/98EC3UcMkZvik39ZAIXlBLMup0zGcIs4wmFLPMnZgQVpUCAw== | Seller Token | Yes      |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing fields or token)

##### Success Response Body Example

`DELETE localhost:4200/products/1`

```
{
    "message": "Product deleted successfully",
    "product": {
        "id": 51,
        "name": "Edit Nama Produk",
        "category": "Movies",
        "price": 3000,
        "in_stock": true,
        "description": "Edit deskripsi produk",
        "created_at": "2024-02-18T03:04:48.534Z",
        "updated_at": "2024-02-18T03:10:55.056Z"
    }
}
```

##### Error Response Body Example

`no product`

```
{
    "message": "Not found"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### View Cart Endpoint

- URL: /cart
- Method: GET
- Content-Type: application/json
- Description: View user's cart based on the token. No authorization for the seller.

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing token or no products)

##### Success Response Body Example

`GET localhost:4200/cart`

```
[
    {
        "id": 1,
        "user_id": 1,
        "product_id": 2,
        "quantity": 2,
        "total": 6814792,
        "created_at": "2024-02-18T03:24:41.196Z",
        "updated_at": "2024-02-18T03:24:41.196Z",
        "product": {
            "id": 2,
            "name": "Handcrafted Bronze Keyboard",
            "category": "Kids",
            "price": 3407396,
            "in_stock": true,
            "description": "New range of formal shirts are designed keeping you in mind. With fits and styling that will make you stand apart",
            "created_at": "2024-02-17T12:52:44.940Z",
            "updated_at": "2024-02-17T12:52:44.940Z"
        }
    }
]
```

##### Error Response Body Example

`no product`

```
{
    "message": "No product in cart"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Add a Product in Cart Endpoint

- URL: /cart
- Method: POST
- Content-Type: application/json
- Description: Add a Product in Cart, needed Body and Header Request for registered token for user role.

#### Request Header and Body

| Key             | Type   | Description                  | Required |
| --------------- | ------ | ---------------------------- | -------- |
| `Authorization` | String | The registered seller token. | Yes      |

| Attribute    | Type   | Description           | Required |
| ------------ | ------ | --------------------- | -------- |
| `product_id` | String | The product id.       | Yes      |
| `quantity`   | String | The product quantity. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description    | Required |
| --------------- | ---------------------------------------------------------------------------------------- | -------------- | -------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer Token | Yes      |

#### Sample Request

```
{

    "product_id" : 2,
    "quantity" : 2
}
```

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing fields or token)

##### Success Response Body Example

`POST localhost:4200/cart`

```
{
    "message": "Cart created successfully",
    "cart": {
        "id": 1,
        "user_id": 1,
        "product_id": 2,
        "quantity": 2,
        "total": 6814792,
        "created_at": "2024-02-18T03:24:41.196Z",
        "updated_at": "2024-02-18T03:24:41.196Z"
    }
}
```

##### Error Response Body Example

`missing fields`

```
{
    "error": "Product ID is required"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Delete a Product in Cart Endpoint

- URL: /cart/1
- Method: DELETE
- Content-Type: application/json
- Description: Delete a Product in cort, needed Header Request for registered token for user role.

#### Request Header

| Attribute    | Type   | Description           | Required |
| ------------ | ------ | --------------------- | -------- |
| `product_id` | String | The product id.       | Yes      |
| `quantity`   | String | The product quantity. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description    | Required |
| --------------- | ---------------------------------------------------------------------------------------- | -------------- | -------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer Token | Yes      |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing token)

##### Success Response Body Example

`DELETE localhost:4200/cart/1`

```
{
    "message": "Product in Cart deleted successfully",
    "cart": {
        "id": 3,
        "user_id": 1,
        "product_id": 1,
        "quantity": 2,
        "total": 7301700,
        "created_at": "2024-02-18T03:47:37.995Z",
        "updated_at": "2024-02-18T03:47:37.995Z"
    }
}
```

##### Error Response Body Example

`no item`

```
{
    "message": "Cart item not found"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Delete Entire Cart Endpoint

- URL: /cart
- Method: DELETE
- Content-Type: application/json
- Description: Delete entire cart, needed Header Request for registered token for user role.

#### Request Header

| Attribute    | Type   | Description           | Required |
| ------------ | ------ | --------------------- | -------- |
| `product_id` | String | The product id.       | Yes      |
| `quantity`   | String | The product quantity. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description    | Required |
| --------------- | ---------------------------------------------------------------------------------------- | -------------- | -------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer Token | Yes      |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing token)

##### Success Response Body Example

`DELETE localhost:4200/cart`

```
{
    "message": "Cart emptied successfully"
}
```

##### Error Response Body Example

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Add Cart to Order Endpoint

- URL: /orders
- Method: POST
- Content-Type: application/json
- Description: Add user's order based on the token. User can put multiple orders

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing token)

##### Success Response Body Example

`POST localhost:4200/orders`

```
{
    "message": "Order created successfully"
}
```

##### Error Response Body Example

`Empty Cart`

```
{
    "message": "Cart is empty"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### View All Order Endpoint

- URL: /orders
- Method: GET
- Content-Type: application/json
- Description: View user's orders based on the token.

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing token)

##### Success Response Body Example

`GET localhost:4200/orders`

```
[
    {
        "id": 2,
        "user_id": 2,
        "date": "2024-02-18T04:00:12.989Z",
        "number": "ORD/411",
        "total": 8030836,
        "created_at": "2024-02-18T04:00:12.990Z",
        "updated_at": "2024-02-18T04:00:12.990Z",
        "order_items": [
            {
                "id": 3,
                "order_id": 2,
                "product_id": 2,
                "quantity": 2,
                "price": 3407396,
                "total": 6814792,
                "created_at": "2024-02-18T04:00:12.990Z",
                "updated_at": "2024-02-18T04:00:12.990Z",
                "product": {
                    "id": 2,
                    "name": "Handcrafted Bronze Keyboard",
                    "category": "Kids",
                    "price": 3407396,
                    "in_stock": true,
                    "description": "New range of formal shirts are designed keeping you in mind. With fits and styling that will make you stand apart",
                    "created_at": "2024-02-17T12:52:44.940Z",
                    "updated_at": "2024-02-17T12:52:44.940Z"
                }
            },
            {
                "id": 4,
                "order_id": 2,
                "product_id": 3,
                "quantity": 2,
                "price": 608022,
                "total": 1216044,
                "created_at": "2024-02-18T04:00:12.990Z",
                "updated_at": "2024-02-18T04:00:12.990Z",
                "product": {
                    "id": 3,
                    "name": "Generic Plastic Soap",
                    "category": "Movies",
                    "price": 608022,
                    "in_stock": false,
                    "description": "Ergonomic executive chair upholstered in bonded black leather and PVC padded seat and back for all-day comfort and support",
                    "created_at": "2024-02-17T12:52:44.943Z",
                    "updated_at": "2024-02-17T12:52:44.943Z"
                }
            }
        ]
    },
    {
        "id": 3,
        "user_id": 2,
        "date": "2024-02-18T04:01:50.954Z",
        "number": "ORD/938",
        "total": 1216044,
        "created_at": "2024-02-18T04:01:50.955Z",
        "updated_at": "2024-02-18T04:01:50.955Z",
        "order_items": [
            {
                "id": 5,
                "order_id": 3,
                "product_id": 3,
                "quantity": 2,
                "price": 608022,
                "total": 1216044,
                "created_at": "2024-02-18T04:01:50.955Z",
                "updated_at": "2024-02-18T04:01:50.955Z",
                "product": {
                    "id": 3,
                    "name": "Generic Plastic Soap",
                    "category": "Movies",
                    "price": 608022,
                    "in_stock": false,
                    "description": "Ergonomic executive chair upholstered in bonded black leather and PVC padded seat and back for all-day comfort and support",
                    "created_at": "2024-02-17T12:52:44.943Z",
                    "updated_at": "2024-02-17T12:52:44.943Z"
                }
            }
        ]
    }
]
```

##### Error Response Body Example

`empty order`

```
{
    "message": "No Orders"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### View an Order Endpoint

- URL: /orders/:id
- Method: GET
- Content-Type: application/json
- Description: View user's order based on the id. Need user's token

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing order or token)

##### Success Response Body Example

`GET localhost:4200/orders/2`

```
{
    "id": 2,
    "user_id": 2,
    "date": "2024-02-18T04:00:12.989Z",
    "number": "ORD/411",
    "total": 8030836,
    "created_at": "2024-02-18T04:00:12.990Z",
    "updated_at": "2024-02-18T04:00:12.990Z",
    "order_items": [
        {
            "id": 3,
            "order_id": 2,
            "product_id": 2,
            "quantity": 2,
            "price": 3407396,
            "total": 6814792,
            "created_at": "2024-02-18T04:00:12.990Z",
            "updated_at": "2024-02-18T04:00:12.990Z",
            "product": {
                "id": 2,
                "name": "Handcrafted Bronze Keyboard",
                "category": "Kids",
                "price": 3407396,
                "in_stock": true,
                "description": "New range of formal shirts are designed keeping you in mind. With fits and styling that will make you stand apart",
                "created_at": "2024-02-17T12:52:44.940Z",
                "updated_at": "2024-02-17T12:52:44.940Z"
            }
        },
        {
            "id": 4,
            "order_id": 2,
            "product_id": 3,
            "quantity": 2,
            "price": 608022,
            "total": 1216044,
            "created_at": "2024-02-18T04:00:12.990Z",
            "updated_at": "2024-02-18T04:00:12.990Z",
            "product": {
                "id": 3,
                "name": "Generic Plastic Soap",
                "category": "Movies",
                "price": 608022,
                "in_stock": false,
                "description": "Ergonomic executive chair upholstered in bonded black leather and PVC padded seat and back for all-day comfort and support",
                "created_at": "2024-02-17T12:52:44.943Z",
                "updated_at": "2024-02-17T12:52:44.943Z"
            }
        }
    ]
}
```

##### Error Response Body Example

`wrong order id`

```
{
    "message": "Order not found"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Delete an Order Endpoint

- URL: /orders/:id
- Method: DELETE
- Content-Type: application/json
- Description: Delete user's order based on the id. Need user's token

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing order or token)

##### Success Response Body Example

`DELETE localhost:4200/orders/2`

```
{
    "message": "Order deleted successfully",
    "order": {
        "id": 2,
        "user_id": 2,
        "date": "2024-02-18T04:00:12.989Z",
        "number": "ORD/411",
        "total": 8030836,
        "created_at": "2024-02-18T04:00:12.990Z",
        "updated_at": "2024-02-18T04:00:12.990Z",
        "order_items": [
            {
                "id": 3,
                "order_id": 2,
                "product_id": 2,
                "quantity": 2,
                "price": 3407396,
                "total": 6814792,
                "created_at": "2024-02-18T04:00:12.990Z",
                "updated_at": "2024-02-18T04:00:12.990Z"
            },
            {
                "id": 4,
                "order_id": 2,
                "product_id": 3,
                "quantity": 2,
                "price": 608022,
                "total": 1216044,
                "created_at": "2024-02-18T04:00:12.990Z",
                "updated_at": "2024-02-18T04:00:12.990Z"
            }
        ]
    }
}
```

##### Error Response Body Example

`wrong order id`

```
{
    "message": "Order not found"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Delete Entire Order Endpoint

- URL: /orders
- Method: DELETE
- Content-Type: application/json
- Description: Delete user's entire orders. Need user's token

#### Request Header

| Key             | Type   | Description                | Required |
| --------------- | ------ | -------------------------- | -------- |
| `Authorization` | String | The registered user token. | Yes      |

#### Sample Header Request on Postman

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing order or token)

##### Success Response Body Example

`DELETE localhost:4200/orders`

```
{
    "message": "Order emptied successfully"
}
```

##### Error Response Body Example

`orders empty`

```
{
    "message": "Orders already Empty"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

### Payment Endpoint

- URL: /pay/:id
- Method: POST
- Content-Type: application/json
- Description: Payment for existed order based on order id and user token. Ensure that you use the provided valid card numbers for testing your payment integrations.

#### Request Header and Body

| Key             | Type   | Description                               | Required |
| --------------- | ------ | ----------------------------------------- | -------- |
| `Authorization` | String | The registered user token.                | Yes      |
| Attribute       | Type   | Description                               | Required |
| -------------   | ------ | ----------------------------------------- | -------- |
| `amount`        | Number | The payment amount in cents.              | Yes      |
| `cardNumber`    | String | The credit card number.                   | Yes      |
| `cvv`           | Number | The card's CVV (Card Verification Value). | Yes      |
| `expiryMonth`   | String | The card's expiry month (MM).             | Yes      |
| `expiryYear`    | String | The card's expiry year (YYYY).            | Yes      |

#### Sample Request for Header and Body Request

| Key             | Value                                                                                    | Description      |
| --------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `Authorization` | n0k+5liZ7uiFW+B9wdlgt0PuuFzBP26GqdVMLyrtmb0wrmAAYe21N/RtS/mzXqncTDHHIaUy+OUCsYwZePetFw== | Customer 1 Token |

```
{
  "amount": 1000000000000000,
  "cardNumber": "4012888888881881",
  "cvv": 20012,
  "expiryMonth": "02",
  "expiryYear": "2024"
}
```

#### Response

##### Success

- Response Code: 200 OK
- Error Response Code: 400 Bad Request (for missing inputs or existed email)

##### Success Response Body

```
{
    "paymentResult": {
        "message": "Payment successful",
        "data": {
            "transcationId": "7302830721502545",
            "amount": 1000000000000000,
            "date": "2024-02-18T04:26:27.040Z"
        }
    }
}
```

##### Error Response Body

`wrong order ID`

```
{
    "message": "Orders already Empty"
}
```

`no token`

```
{
    "message": "Token is required"
}
```

`invalid token`

```
{
    "message": "Invalid Token"
}
```

## Usage

This API is designed for development and testing purposes only and should not be used in production environments.

## Acknowledgments

This project was done with the usage of:

- [Dummy Payment Gateway](https://github.com/harrymahardhika/dummy-payment-gateway)
- [Express Shopping Cart](https://github.com/harrymahardhika/express-shopping-cart)
